<div class="controls-container">
  <app-scene [rotationMatrix]="activeMatrix()"></app-scene>

  <div class="dashboard-row">
    <div class="panel">
      <h3>Set Initial Transformation</h3>
      <select #rotSelect
        (change)="updateInitialSelection(rotSelect.value, x.valueAsNumber, y.valueAsNumber, z.valueAsNumber)">
        @for (option of matrixOptions; track option.generatorPath) {
        <option [value]="option.generatorPath">
          {{option.generatorPath}} - {{ option.schoenflies }}
        </option>
        }
      </select>

      <div class="slider-row">
        <label for="xRange">X: {{x.value}}</label>
        <input #x id="xRange" type="range" min="0" max="5" step="1" [value]="posX()"
          (input)="updateInitialSelection(rotSelect.value, x.valueAsNumber, y.valueAsNumber, z.valueAsNumber)">
      </div>

      <div class="slider-row">
        <label for="yRange">Y: {{y.value}}</label>
        <input #y id="yRange" type="range" min="0" max="5" step="1" [value]="posY()"
          (input)="updateInitialSelection(rotSelect.value, x.valueAsNumber, y.valueAsNumber, z.valueAsNumber)">
      </div>

      <div class="slider-row">
        <label for="zRange">Z: {{z.value}}</label>
        <input #z id="zRange" type="range" min="0" max="5" step="1" [value]="posZ()"
          (input)="updateInitialSelection(rotSelect.value, x.valueAsNumber, y.valueAsNumber, z.valueAsNumber)">
      </div>

      <div class="status-msg">
        @if (gridStateService.initialPiece(); as init) {
        <span style="color: #4caf50;">Piece fits! Row ID: {{ gridStateService.initialRowId() }}</span>
        } @else {
        <span style="color: #f44336;">Piece exceeds boundaries.</span>
        }
      </div>
    </div>

    <div class="panel">
      <h3>Initial Rotation Matrix</h3>
      <div class="matrix-wrapper">
        <matrix-display [matrix]="activeMatrix()"></matrix-display>
      </div>
      <div class="path-display">
        <small>Sequence: {{ activeRotation().generatorPath }}</small><br>
        <small>Symmetry: {{ activeRotation().signedPermutation }}</small>
      </div>
    </div>

    <div class="panel">
      <h3>Solver Controls</h3>
      <div class="button-group">
        <button (click)="solve()">Quick Solve</button>
        <button (click)="animateSolution()">Animate Slowly</button>
        <button (click)="clearSolution()">Reset</button>
      </div>

      <div class="slider-container">
        <label for="speed">Animation Delay: {{ gridStateService.delayMs() }}ms</label>
        <input id="speed" type="range" min="0" max="1000" step="10" [value]="gridStateService.delayMs()"
          (input)="updateSpeed($event)" />
      </div>
    </div>
  </div>
</div>